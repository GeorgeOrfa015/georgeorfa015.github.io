<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTIKO KTEL TELEMATICS but better</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Zalando+Sans+Expanded:ital,wght@0,200..900;1,200..900&display=swap');
        ::-webkit-scrollbar {
            display: none;
        }


        body{
            background-color: #000;
            color: #fff;
            font-family: "Manrope";
            font-size: 1vw;
        }
        div{
            border: 0px solid red;
        }
        #date{
            text-align: center;
            font-size: 1vw;
            width: fit-content;
            backdrop-filter: blur(0.2vw);
            padding: .3vw .7vw;
            border-radius: 5vw;
            background-color: #2225;
            box-shadow: inset 0 0 0.6vw #fff3;
            white-space: nowrap;
            font-weight: 600;
        }
        #infoContainer{
            position: fixed;
            bottom: 0.3vw;
            transform: translateX(-50%);
            left: 50%;
            display: grid;
            grid-template-columns: auto auto;
            gap: 0.3vw;
            z-index: -1;
        }
        #outerCont{
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1vw;
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100% - 1.5vw);
            height: auto;
            max-height: calc(100%) - 2vw;
            padding: 0.75vw;
            overflow: scroll;
            z-index: -2;
            padding-bottom: 2.6vw;
        }
        .innerCont{
            display: grid;
            grid-template-columns: 1fr;
            grid-template-rows: auto;
            gap: 0.5vw;
            padding: 0.5vw;
            height: fit-content;
            overflow-y: scroll;
            max-height: 15.5vw;
            width: calc(100% - 1vw);
        }
        
        .item{
            display: grid;
            grid-template-columns: auto 2fr auto;
            height: fit-content;
            max-width: 100%;
            background: #292929;
            border-radius: 0.2vw;
        }
        .LineID{
            background-color: #056c30;
            width: 1.5vw;
            padding: 0.2vw 0.5vw;
            border-radius: 0.2vw;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: 600;
            
        }
        .LineNameCont{
            display: grid;
            padding: 0.2vw 0.5vw;
            width: 100%;
            overflow: hidden;
            white-space: nowrap;
        }
        .LineName{
            font-size: 1vw;
            display: inline-block;
        }
        .ArrivalTimeCont{
            padding: 0.2vw 0.5vw;
            text-align: right;
            display: grid;
        }
        .ArrivalTime{
            font-size: 1vw;
        }
        .ArrivalDate{
            font-size: 0.85vw;
            color: #bbb;
        }
        .module{
            display: grid;
            background: #222;
            grid-template-columns: 1fr;
            grid-template-rows: auto 1fr;
            border-radius: 0.5vw;
            overflow: hidden;
            height: 20vw;
        }
        .header{
            background: #444;
            text-align: center;
            font-weight: 500;
            font-size: 1.25vw;
            padding: 0.5vw;
            height: 2.5vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            white-space: nowrap;
            transition: 0.2s background;
        }
        .headerText{
            white-space: nowrap;
            display: inline-block;
            width: max-content;
        }
        .scroll{
            animation: scroll-text 8s ease-in-out infinite;
            animation-direction: alternate;
        }
        .scrollLine{
            animation: scroll-line 8s ease-in-out infinite;
            animation-direction: alternate;
        }
        .scrollStop{
            animation: scroll-stop 10s ease-in-out infinite;
            animation-direction: alternate;
        }
        @keyframes scroll-text {
            0%   { transform: translateX(15%); }
            100% { transform: translateX(-15%); }
        }
        
        @keyframes scroll-line {
            0%   { transform: translateX(0%); }
            100%   { transform: translateX(-10%); }
        }
        @keyframes scroll-stop {
            0%   { transform: translateX(0%); }
            100%   { transform: translateX(-10%); }
        }
        .none{
            text-align: center;
            font-size: 1.25vw;
            color: #fff;
        }
        .gps{
            color: #bbb;
            font-size: 0.85vw;
        }
        .live{
            color: #30d158
        }
        #settingsBackdrop{
            width: 100%;
            height: 100%;
            position: fixed;
            top: 0;
            left: 0;
            background: #0004; /*url(data:image/jpeg;base64,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);*/
            backdrop-filter: blur(0.2vw);
            opacity: 0;
            display: none;
            transition: 0.2s
        }
        #settingsSubmenuBackdrop{
            backdrop-filter: blur(0.2vw);
            z-index: 2;
            display: none;
            width: 100%;
            height: 100%;
            background: #0004;
            position: fixed;
        }
        #settings{
            width: 40vw;
            height: 60vh;
            background: #222222ee;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            backdrop-filter: blur(0.3vw);
            border-radius: 1.25vw;
            z-index: 2;
            box-shadow: inset 0 0 0.3vw #fff2;
            display: none;
            grid-template-columns: 1fr;
            grid-template-rows: 2vw 2vw 2.4vw auto 2vw;
            gap: 0.5vw;
            padding-top: 0.75vw;
            padding-bottom: 0.75vw;
        }
        .settingsHeader{
            font-size: 1.25vw;
            font-weight: 700;
            align-self: center;
            padding-left: 0.2vw
        }
        #settingsButtonsCont{
            height: fit-content;
            padding: 0 0.75vw;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5vw;
        }
        #settingsGroupCont{
            height: fit-content;
            margin: 0 0.75vw;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 0.25vw;
            background-color: #333a;
            border-radius: 0.7vw;
            padding: 0.2vw
        }
        button{
            color: #fff;
            background: #056c30aa;
            border: none;
            border-radius: 0.5vw;
            backdrop-filter: blur(0.2vw);
            padding: 0.3vw 0.7vw;
            font-size: 1vw;
            font-weight: 600;
            font-family: "Manrope";
            transition: 0.1s background, 0.2s border;
            height: 2vw;
        }
        input{
            color: #fff;
            background: #056c30aa;
            border: none;
            border-radius: 0.5vw;
            backdrop-filter: blur(0.2vw);
            padding: 0 0.4vw;
            font-size: 1vw;
            font-weight: 600;
            font-family: "Manrope";
            transition: 0.1s background, 0.2s border;
            height: 2vw;
            width: calc(100% - 0.8vw);
        }
        input:focus{
            outline:none;
        }
        button:hover{
            background: #168d48aa;
        }
        .groupButton{
            background: none;
            box-shadow: none;
            transition: 0.2s background, 0.2s border;
        }
        .groupButton:hover{
            background: #8881;
        }
        .selected{
            background: #aaa3;
        }
        .selected:hover{
            background: #aaa3;
            
        }
        #stopsList{
            margin: 0 0.75vw;
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.25vw;
            background-color: #333a;
            border-radius: 0.9vw;
            padding: 0.2vw;
            height: calc(100% - 0.4vw);
            overflow: scroll;
        }
        #topStuffCont{
            padding: 0 0.75vw;
            display: grid;
            grid-template-columns: 3.1fr 1fr 2fr;
            gap: 0.4vw;
        }
        .destructive{
            background: #cf4141af;
        }
        .destructive:hover{
            background: #e75e5eaf;
        }
        .generic{
            background: #bbb4;
        }
        .generic:hover{
            background: #aaa7;
        }
        .stopInfo{
            background: #444;
            height: fit-content;
            border-radius: 0.7vw;
            padding: 0.3vw;
            display: grid;
            grid-template-columns: 3vw 1fr 2vw 2vw 2vw;
            gap: 0.3vw
        }
        .settingsStopName{
            align-self: center;
            padding-left: 0.1vw;
            white-space: nowrap;
            overflow: hidden;
            display: inline-block;
        }
        .settingsStopNameText{
            display: inline-block;
            width: max-content;
        }
        .settingsStopId{
            align-self: center;
            background: #1b6138;
            text-align: center;
            border-radius: 0.5vw;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .stopInfoButton{
            font-size: 0.75vw;
            width: 2vw;
            padding: 0;
            aspect-ratio: 1;
            font-family: "Zalando Sans Expanded";
        }
        .stopInfoButton.generic{
            background: #666
        }
        .stopInfoButton.generic:hover{
            background: #777
        }
        .stopInfoButton.destructive{
            background: #aa4040
        }
        .stopInfoButton.destructive:hover{
            background: #aa4c4c
        }
        .exitButtons{
            margin: 0 0.75vw;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5vw;
        }
        #settingsButton{
            background: #056c3055;
            color: #fff;
            border: none;
            border-radius: 10vw;
            backdrop-filter: blur(0.2vw);
            box-shadow: inset 0 0 0.3vw #fff4;
            padding: 0.3vw 0.7vw;
            font-size: 1vw;
            font-weight: 600;
            font-family: "Manrope";
            transition: 0.1s background, 0.2s border;
            height: 2vw;
        }
        #settingsButton:hover{
            background: #168d4888;
        }
        #stopsListInnerCont{
            gap: 0.3vw;
            display: grid;
            height: fit-content;
        }
        .settingsSubmenu{
            display: none;
            background: #555e;
            z-index: 3;
            height: fit-content;
            width: 20vw;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            backdrop-filter: blur(0.15vw);
            padding: 0.75vw;
            border-radius: 1.25vw;
            box-shadow: inset 0 0 0.3vw #fff7;
            gap: 0.5vw;
        }
        #newStop{
            grid-template-columns: 1fr 1fr 1fr 1fr;
        }
        #newStopAdd, #newStopCancel{
            grid-column: span 2;
        }
        #stopNameOutput{
            grid-column: span 4;
        }
        .label{
            align-self: center;
        }
        #stopInput{
            grid-column: span 3;
        }
        .settingsSubmenu > #newStopAdd{
            background: #2b9b5add;
            transition: 0.2s background, 0.2s color;
            cursor: pointer;
        }
        .settingsSubmenu > #newStopAdd:disabled{
            background: #2a774add;
            color: #aaa;
            cursor:default;
        }
        .settingsSubmenu > input{
            background: #1d8548dd
        }
        #stopNameOutput{
            min-height: 2vw;
            align-content: center;
            text-align: center;
        }
        .error{
            font-style: italic;
            color: #ddd;
        }
        @media(max-width:700px) {
            #outerCont{
                grid-template-columns: 1fr;
                gap: 2vw;
                padding-bottom: 8.6vw;
            }
            .module{
                border-radius: 2vw;
                height: 64.5vw;
            }
            .header{
                height: 9vw;
                font-size: 4vw;
                font-weight: 800;
            }
            .LineName, .ArrivalTime{
                font-size: 3.9vw;
                font-weight: 400;
            }
            .ArrivalTimeCont{
                padding-left: 1vw;
            }
            .LineNameCont{
                width: 100%;
                white-space: nowrap;
            }
            .LineID{
                width: 10vw;
                border-radius: 1.5vw;
                font-size: 4vw;
                padding: 0vw;
            }
            .innerCont{
                gap: 2vw;
                padding: 2vw;
                max-height: 50.5vw;
                width: calc(100% - 4vw);
            }
            .item{
                gap: 1.5vw;
                max-width: 100%;
                border-radius: 1.5vw;
            }
            .none{
                font-size: 3.5vw;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            #date{
                text-align: center;
                font-size: 3vw;
                width: fit-content;
                backdrop-filter: blur(0.4vw);
                padding:  2vw 4vw;
                border-radius: 5vw;
                background-color: #2225;
                box-shadow: inset 0 0 0.6vw #fff3;
                white-space: nowrap;
                font-weight: 600;;
            }
            #infoContainer{
                position: fixed;
                bottom: 0.3vw;
                transform: translateX(-50%);
                left: 50%;
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1vw;
                z-index: -1;
                align-items: center;
                text-align: center;
            }
            button{
                font-size: 3vw;
                height: 8vw;
                padding:  1vw 4vw;

                text-align: center;
                margin: auto;
                backdrop-filter: blur(0.4vw);
                width: 100%;
                border-radius: 2vw;
            }
            input{
                border-radius: 2vw;
                backdrop-filter: blur(0.2vw);
                padding: 0 1.5vw;
                font-size: 4vw;
                font-weight: 600;
                font-family: "Manrope";
                transition: 0.1s background, 0.2s border;
                height: 8vw;
                width: calc(100% - 3vw);
            }
            #settingsButton{
                font-size: 3vw;
                height: 8vw;
                padding:  1vw 4vw;
                box-shadow: inset 0 0 0.6vw #fff3;
                text-align: center;
                margin: auto;
                backdrop-filter: blur(0.4vw);
                width: 100%;
            }
            .gps, .ArrivalDate{
                font-size: 3.5vw;
            }
            @keyframes scroll-text {
            0%   { transform: translateX(20%); }
            100% { transform: translateX(-20%); }
            }

            @keyframes scroll-line {
            0%   { transform: translateX(0%); }
            100%   { transform: translateX(-30%); }
            }
            @keyframes scroll-stop {
                0%   { transform: translateX(0%); }
                100%   { transform: translateX(-50%); }
            }
            #settings{
                width: 95vw;
                height: 90vh;
                backdrop-filter: blur(0.3vw);
                border-radius: 3vw;
                box-shadow: inset 0 0 0.3vw #fff2;
                grid-template-rows: 8vw 8vw 10vw auto 8vw;
                gap: 1.5vw;
                padding-top: 2vw;
                padding-bottom: 2vw;
            }
            #settingsBackdrop{
                backdrop-filter: blur(0.6vw);
            }
            .settingsHeader{
                font-size: 5vw;
                font-weight: 700;
                align-self: center;
                padding: 0;
                text-align: center;
            }
            #topStuffCont{
                grid-template-columns: 1fr;
            }
            #settingsButtonsCont{
                padding: 0 2vw;
                gap: 1.5vw;
            }
            #settingsGroupCont{
                margin: 0 2vw;
                padding: 1vw;
                gap: 1.25vw;
                border-radius: 2.5vw;
            }
            #stopsList{
                margin: 0 2vw;
                border-radius: 2.5vw;
                padding: 1vw;
                height: calc(100% - 2vw);
            }
            .exitButtons{
                margin: 0 2vw;
                gap: 1.25vw;
            }
            .stopInfo{
                grid-template-columns: 12vw 1fr 8vw 8vw 8vw;
                border-radius: 2vw;
                padding: 1vw;
                gap: 0.75vw;
            }
            .settingsStopId{
                font-size: 3.5vw;
                border-radius: 1vw;
                font-weight: 700;
            }
            .stopInfoButton{
                font-size: 3.5vw;
                width: 8vw;
                padding: 0;
            }
            .settingsStopName{
                font-size: 3.5vw;
                padding-left: 0.5vw;
                white-space: unset;
            }
            .settingsStopNameText{
                white-space:initial;
                width: 100%;
            }
            #stopsListInnerCont{
                gap: 1vw;
            }
            .settingsSubmenu{
                max-height: 30vw;
                width: 90vw;
                backdrop-filter: blur(0.3vw);
                padding: 2vw;
                border-radius: 3vw;
                box-shadow: inset 0 0 0.5vw #fff7;
                gap: 1.5vw;
            }
            .label{
                align-self: center;
                font-size: 4vw;
            }
            .settingsSubmenu > #newStopAdd{
                background: #2b9b5add;
                transition: 0.2s background, 0.2s color;
                cursor: pointer;
            }
            .settingsSubmenu > #newStopAdd:disabled{
                background: #2a774add;
                color: #aaa;
                cursor:default;
            }
            .settingsSubmenu > input{
                background: #1d8548dd
            }
            #stopNameOutput{
                min-height: 8vw;
                align-content: center;
                text-align: center;
                font-size: 4vw;
            }
            .error{
                font-style: italic;
                color: #ddd;
            }
        }

    </style>
</head>
<body>
    <div id="outerCont">

    </div>
    <div id="settings">
        <div id="topStuffCont">
            <span class="settingsHeader">Settings > Stop management</span>
        </div>
        <div id="settingsButtonsCont">
            <button id="newStopButton" onclick="openSubmenu1()">Add Stop</button>
            <button id="saveCodeButton">Export/Import</button>
        </div>
        <div id="settingsGroupCont">
            <button id="group1button" class="groupButton selected">Group 1</button>
            <button id="group2button" class="groupButton">Group 2</button>
            <button id="group3button" class="groupButton">Group 3</button>
        </div>

        <div id="stopsList">
            <div id="stopsListInnerCont">
                <!-- <div class="stopInfo">
                    <div class="settingsStopId">0703</div>
                    <div class="settingsStopName">
                        <span class="settingsStopNameText">ΑΜΝΙΣΣΟΣ -ΠΑΡΑΛΙΑ ΚΑΡΤΕΡΟΥ-ΑΘΛΗΤΙΚΕΣ ΕΓΚΑΤΑΣΤΑΣΕΙΣ</span>
                    </div>
                    <button class="stopInfoButton generic">↑</button>
                    <button class="stopInfoButton generic">↓</button>
                    <button class="stopInfoButton destructive">X</button>
                </div>
                <div class="stopInfo">
                    <div class="settingsStopId">0714</div>
                    <div class="settingsStopName">
                        <span class="settingsStopNameText">ΕΛΕΥΘΕΡΙΟΥ ΒΕΝΙΖΕΛΟΥ ΑΡΩΜΑΤΙΚΑ</span>
                    </div>
                    <button class="stopInfoButton generic">↑</button>
                    <button class="stopInfoButton generic">↓</button>
                    <button class="stopInfoButton destructive">X</button>
                </div> -->
            </div>
        </div>
        <div class="exitButtons">
            
            <button id="closeButton" class="generic" onclick="closeSettings()">Close without saving</button>
            <button id="saveButton" class="destructive" onclick="saveReload()">Save & Reload</button>
        </div>
    </div>
    <div id="settingsBackdrop">
    </div>
    <div class="settingsSubmenu" id="newStop">
        <span class="label">Stop ID:</span>
        <input type="text" id="stopInput" oninput="addStopType()">
        <span id="stopNameOutput" class="error">Invalid stop</span>
        <button id="newStopCancel" class="generic" onclick="closeSubmenu1()">Cancel</button>
        <button id="newStopAdd" disabled onclick="addStop()">Add Stop</button>
    </div>
    <div id="settingsSubmenuBackdrop"></div>
    <div id="infoContainer">
        <button onclick="openSettings()" id="settingsButton">Settings</button>
        <div id="date">Fetching data...</div>
    </div>
    <script>
        delay = 20000
        let testValue = {
            "vehicles":[
                {
                    "vehicleCode":"20260105_31015_1000000_23_15",
                    "borderColor":"#AC0000",
                    "longitude":"25.124617",
                    "latitude":"35.336471",
                    "departureSeconds":53,
                    "lineName":"AIRPORT",
                    "departureMins":3,
                    "routeCode":"31015",
                    "routeName":"HERAKLION HOSPITAL (PAGNI) - AIRPORT",
                    "lineCode":"06",
                    "lineColor":"#2e7d32",
                    "lineTextColor":"#ffffff"
                },
                {
                    "vehicleCode":"20260105_31015_1000000_23_15",
                    "borderColor":"#AC0000",
                    "longitude":"25.124617",
                    "latitude":"35.336471",
                    "departureSeconds":53,
                    "lineName":"AIRPORT",
                    "departureMins":5,
                    "routeCode":"31015",
                    "routeName":"GAZI - AIRPORT",
                    "lineCode":"11",
                    "lineColor":"#b71c1c",
                    "lineTextColor":"#ffffff"
                },
                {
                    "vehicleCode":"20260105_31009_1000000_23_15",
                    "borderColor":"#AC0000",
                    "longitude":"25.081521",
                    "latitude":"35.335661",
                    "departureSeconds":34,
                    "lineName":"AIRPORT",
                    "departureMins":13,
                    "routeCode":"31018",
                    "routeName":"AMOUDARA - AIRPORT",
                    "lineCode":"50",
                    "lineColor":"#787878",
                    "lineTextColor":"#ffffff"
                }
            ]
        }

        function calcDistance(lat1, lon1, lat2, lon2) {
            const R = 6371000; // Earth radius in meters
            const toRad = deg => deg * Math.PI / 180;

            const f1 = toRad(lat1);
            const f2 = toRad(lat2);
            const Df = toRad(lat2 - lat1);
            const Dl = toRad(lon2 - lon1);

            const a =
                Math.sin(Df / 2) ** 2 +
                Math.cos(f1) * Math.cos(f2) *
                Math.sin(Dl / 2) ** 2;

            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));

            return R * c;
        }


        async function getData(key, id) {
            const response = await fetch(
                "https://corsproxy.io/?https://rest.citybus.gr/api/v1/el/110/stops/live/" + id,
                {
                    cache: "no-store",
                    headers: {
                        "Authorization": key,
                        "Cache-Control": "no-cache, no-store, must-revalidate",
                        "Pragma": "no-cache",
                        "Expires": "0"
                    }
                }
            );


            // return testValue;
            // if (!response.ok) {
            //     throw new Error(`HTTP error: ${response.status}`);
            // }

            return await response.json();
        }
        
        
        async function getHTML(id) {
            const url = "https://corsproxy.io/?https://irakleio.citybus.gr/stops/live/"+id;
            const response = await fetch(url);
            
            if (!response.ok) {
                throw new Error(`HTTP error: ${response.status}`);
            }
            
            return await response.text();
        }
        function updateScroll(ticker, element, className) {
            const span = ticker.querySelector(element);
            span.classList.toggle(
                className,
                span.scrollWidth > ticker.clientWidth
            );
        }

        let colorDict = {
            L01: "#c42a19",
            L02: "#7e786f",
            L03: "#8c705d",
            L04: "#570096",
            L05: "#7e0d48",
            L06: "#4b8136",
            L07: "#6483db",
            L09: "#360408",
            L10: "#7e786f",
            L11: "#d82e5c",
            L12: "#2e4bf2",
            L14: "#7e786f",
            L15: "#487f83",
            L16: "#4c007d",
            L17: "#e89c31",
            L19: "#5300d9",
            L20: "#6fb454",
            L23: "#23211e",
            L21: "#e24172",
            L31: "#4f585c",
            L50: "#000080",
            L91: "#dd6059",
            L92: "#5f6ee5",
            L93: "#65c251"
        }
        let stop_id = "9911"
        let key;
        function createWidget(stop_id, order) {
            
            getHTML(stop_id).then(html => {
                let name = html.split("Στάση:<br/><span>")[1].split("</span>'")[0]
                let stopLat = html.split("'latitude': ")[1].split(",")[0]
                let stopLong = html.split("'longitude': ")[1].split(",")[0]
                key = "Bearer " + html.split("token = '")[1].split("';")[0]

                let module = document.createElement("div");
                module.className = "module";
                module.style.order = order

                let header = document.createElement("div");
                header.className = "header"
                header.id = "header"+stop_id

                let headerText = document.createElement("span");
                headerText.innerHTML = name;
                headerText.className = "headerText"

                let innerCont = document.createElement("div")
                innerCont.className = "innerCont";
                innerCont.id = "innerCont"+stop_id


                header.appendChild(headerText)
                document.fonts.ready.then(() => {
                    updateScroll(header, 'span', 'scroll');
                });
                module.appendChild(header)
                module.appendChild(innerCont)
                document.getElementById("outerCont").appendChild(module)
                
                function loop() {
                    
                    header.style.background = "#555"
                    
                    getData(key,stop_id).then(data => {
                        header.style.background = "#444"
                        innerCont.innerHTML = ""
                        
                        data.vehicles.forEach(route => {
                            
                            // console.table(route)
                            // console.log(route.lineCode)
                            // console.log(route.routeName)
                            // console.log(route.departureMins)
                            
                            let mins = route.departureMins
                            let name = route.routeName
                            let number = route.lineCode
                            let color = route.lineColor
                            let busLat = route.latitude
                            let busLong = route.longitude
                            let distance, isLocationAvailable;
                            
                            if (busLong != 0) {
                                distance = calcDistance(busLat, busLong, stopLat, stopLong).toFixed(2);
                                if (distance >= 0) {
                                    distance = (distance/1000).toFixed(1)+" km"
                                }else{
                                    distance = distance + " m"
                                }
                                isLocationAvailable = true
                            }else{
                                distance = "No GPS data"
                                isLocationAvailable = false
                            }
                            // console.log(distance)
                            
                            let item = document.createElement("div")
                            item.className = "item";
                            
                            let LineID = document.createElement("div")
                            LineID.innerHTML = number;
                            LineID.style.background = colorDict["L"+number]
                            LineID.className = "LineID"
                            
                            let LineNameCont = document.createElement("div");
                            LineNameCont.className = "LineNameCont";
                            
                            let LineName = document.createElement("span");
                            LineName.innerHTML = name;
                            LineName.className = "LineName";

                            
                            let LineDistance = document.createElement("span");
                            LineDistance.innerHTML = distance;
                            if (isLocationAvailable) {
                                LineDistance.className = "gps live";
                            }else{
                                LineDistance.className = "gps";
                            }

                            let ArrivalTimeCont = document.createElement("div")
                            ArrivalTimeCont.className = "ArrivalTimeCont"

                            let ArrivalTime = document.createElement("span");
                            ArrivalTime.innerHTML = mins+"'";
                            ArrivalTime.className = "ArrivalTime"

                            let timeNow = new Date(new Date().getTime()+(mins*60000))

                            let ArrivalDate = document.createElement("span")
                            ArrivalDate.className = "ArrivalDate"
                            ArrivalDate.innerHTML = `${("0" + timeNow.getHours()).slice(-2)}:${("0" + timeNow.getMinutes()).slice(-2)}`
                            
                            item.appendChild(LineID)
                            LineNameCont.appendChild(LineName)
                            LineNameCont.appendChild(LineDistance)
                            item.appendChild(LineNameCont);
                            document.fonts.ready.then(() => {
                                updateScroll(LineNameCont, ".LineName", 'scrollLine');
                            });
                            ArrivalTimeCont.appendChild(ArrivalTime)
                            ArrivalTimeCont.appendChild(ArrivalDate)
                            item.appendChild(ArrivalTimeCont);
                            innerCont.appendChild(item)
                            
                        })
                        document.getElementById("date").innerHTML = "Last update: "+`${new Date().getFullYear()}-${("0" + new Date().getMonth()+1).slice(-2)}-${("0" + new Date().getDate()).slice(-2)} ${("0" + new Date().getHours()).slice(-2)}:${("0" + new Date().getMinutes()).slice(-2)}:${("0" + new Date().getSeconds()).slice(-2)}`;
                    })
                    .catch(err => {
                        innerCont.innerHTML = ""
                        console.log("No arrivals in the next 30 minutes.")
                        let item = document.createElement("div");
                        item.style.gridColumn = "span 3";
                        item.innerHTML = "Δεν αναμένονται αφίξεις."
                        item.className = "none"
                        innerCont.appendChild(item);
                    })
                }
                loop();
                setInterval(loop, 20000)
            })
        }
        let list = localStorage.getItem("busList")
        if (list != null) {
            list = localStorage.getItem("busList").split(",")
        }else{
            list = []
        }
        if (list[0] == '') {
            list = []
        }
        let templist = [...list]
        //     "0714",
        //     "0710",
        //     "1030",
        //     "2215",
        //     "1104",
        //     "1116",
        //     "0122",
        //     "0120",
        //     "0307",
        let i = 0;
        list.forEach(code => {
            newWidget(code);
        });
        function newWidget(stop_id) {
            i++;
            createWidget(stop_id, i)
        }
        
        function updateAllScroll() {
            document.querySelectorAll(".header").forEach(header => {
                updateScroll(header, 'span', 'scroll');
            });

            document.querySelectorAll(".LineNameCont").forEach(cont => {
                updateScroll(cont, ".LineName", 'scrollLine');
            });

            document.querySelectorAll(".settingsStopName").forEach(cont => {
                updateScroll(cont, ".settingsStopNameText", 'scrollStop')
            });
        }
        let resizeTimeout;
        window.addEventListener("resize", () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(updateAllScroll, 10);
        });
        // ^ Stop arrivals

        // Stop names and stop managing
        async function getKey() {
            const url = "https://corsproxy.io/?https://irakleio.citybus.gr/stops/live/0122";
            const response = await fetch(url);
            
            if (!response.ok) {
                throw new Error(`HTTP error: ${response.status}`);
            }
            
            return await response.text()
        }

        async function getStopsData(key) {
            const response = await fetch(
                "https://corsproxy.io/?https://rest.citybus.gr/api/v1/el/110/stops",
                {
                    cache: "no-store",
                    headers: {
                        "Authorization": key,
                        "Cache-Control": "no-cache, no-store, must-revalidate",
                        "Pragma": "no-cache",
                        "Expires": "0"
                    }
                }
            );
            return await response.json();
        }

        function createStopList(array) {
            let i = 0
            array.forEach(item => {
                let settingsItemCont = document.createElement("div")
                settingsItemCont.className = "stopInfo"
                
                let settingsItemID = document.createElement("div")
                settingsItemID.innerHTML = item 
                settingsItemID.className = "settingsStopId" 
                
                let settingsItemName = document.createElement("div")
                settingsItemName.className = "settingsStopName"
                
                let settingsItemNameText = document.createElement("span");
                settingsItemNameText.innerHTML = stopsArray[item].name
                settingsItemNameText.className = "settingsStopNameText"
                
                
                let settingsUpButton = document.createElement("button")
                settingsUpButton.innerHTML = "↑"
                settingsUpButton.className = "generic stopInfoButton"
                settingsUpButton.setAttribute("onclick", `moveUp(${i})`)
                
                let settingsDownButton = document.createElement("button")
                settingsDownButton.innerHTML = "↓"
                settingsDownButton.className = "generic stopInfoButton"
                settingsDownButton.setAttribute("onclick", `moveDown(${i})`)
                
                let settingsDeleteButton = document.createElement("button")
                settingsDeleteButton.innerHTML = "X"
                settingsDeleteButton.className = "destructive stopInfoButton"
                settingsDeleteButton.setAttribute("onclick", `deleteItem(${i})`)

                let blank = document.createElement("span")
                blank.innerHTML = "&nbsp;"
                let blank2 = document.createElement("span")
                blank2.innerHTML = "&nbsp;"
                settingsItemCont.appendChild(settingsItemID)
                settingsItemName.appendChild(settingsItemNameText)
                settingsItemCont.appendChild(settingsItemName)
                if (i == array.length-1 && i == 0) {
                    settingsItemCont.appendChild(blank)
                    settingsItemCont.appendChild(blank2)
                    settingsItemCont.appendChild(settingsDeleteButton)
                }else if (i == array.length-1){
                    settingsItemCont.appendChild(settingsUpButton)
                    settingsItemCont.appendChild(blank)
                    settingsItemCont.appendChild(settingsDeleteButton)
                }else if (i == 0){
                    settingsItemCont.appendChild(blank)
                    settingsItemCont.appendChild(settingsDownButton)
                    settingsItemCont.appendChild(settingsDeleteButton)
                }else{
                    settingsItemCont.appendChild(settingsUpButton)
                    settingsItemCont.appendChild(settingsDownButton)
                    settingsItemCont.appendChild(settingsDeleteButton)
                }
                document.getElementById("stopsListInnerCont").appendChild(settingsItemCont)
                i++;
                
                // console.log(stopsArray[item])
            });
            document.fonts.ready.then(() => {
                updateAllScroll();
            });
        }

        let stopsArray = new Object();
        getKey().then(html => {
            key = "Bearer " + html.split("token = '")[1].split("';")[0]
            // console.log(key)
            let outerCont = document.getElementById("outerCont")
            getStopsData(key).then(data => {
                data.forEach(stop => {
                    stopsArray[stop.code] = new Object()
                    stopsArray[stop.code].latitude = stop.latitude
                    stopsArray[stop.code].longitude = stop.longitude
                    stopsArray[stop.code].lineCodes = stop.lineCodes
                    stopsArray[stop.code].name = stop.name
                });
                
            })
            return null;
        })
        


        function closeSettings(){
            let backdrop = document.querySelector("#settingsBackdrop")
            let settings = document.querySelector("#settings")
            backdrop.style.display = "none";
            settings.style.display = "none"
            document.querySelectorAll(".stopInfo").forEach(element => {
                element.remove();
            })
        }
        
        function closeSubmenu1(){
            let backdrop = document.querySelector("#settingsSubmenuBackdrop")
            let settings = document.querySelector("#newStop")
            backdrop.style.display = "none";
            settings.style.display = "none"
        }
        function openSettings(){
            let backdrop = document.querySelector("#settingsBackdrop")
            let settings = document.querySelector("#settings")
            backdrop.style.display = "block";
            backdrop.style.opacity = 1;
            settings.style.display = "grid"
            document.fonts.ready.then(() => {
                updateAllScroll();
            });            
            createStopList(list)
            templist = [...list]

        }
        function openSubmenu1(){
            let backdrop = document.querySelector("#settingsSubmenuBackdrop")
            let settings = document.querySelector("#newStop")
            backdrop.style.display = "block";
            backdrop.style.opacity = 1;
            settings.style.display = "grid"
            document.getElementById("stopInput").focus();
        }
        function moveUp(index){
            temp = templist[index]
            templist[index] = templist[index-1]
            templist[index-1] = temp
            document.querySelectorAll(".stopInfo").forEach(element => {
                element.remove();
            })
            createStopList(templist)
        }

        function moveDown(index){
            temp = templist[index]
            templist[index] = templist[index+1]
            templist[index+1] = temp
            document.querySelectorAll(".stopInfo").forEach(element => {
                element.remove();
            })
            createStopList(templist)
        }

        function deleteItem(index) {
            templist.splice(index, 1)
            document.querySelectorAll(".stopInfo").forEach(element => {
                element.remove();
            })
            createStopList(templist)
        }

        function addStopType(){
            let value = document.getElementById("stopInput").value
            let output = document.getElementById("stopNameOutput")
            let button = document.getElementById("newStopAdd")
            if (value in stopsArray) {
                output.innerHTML = stopsArray[value].name
                output.className = ""
                button.disabled = false
            }else{
                output.innerHTML = "Invalid stop"
                output.className = "error"
                button.disabled = true
            }
        }
        
        function addStop(){
            let value = document.getElementById("stopInput").value
            templist.push(value)
            document.querySelectorAll(".stopInfo").forEach(element => {
                element.remove();
            })
            createStopList(templist)
            closeSubmenu1()
            document.getElementById("stopInput").value = ""
            addStopType()
        }
        function saveReload(){
            let items = document.querySelectorAll(".settingsStopId")
            let saveList = new Array();
            items.forEach(item => {
                saveList.push(item.innerHTML)
            });
            console.log(saveList)
            localStorage.setItem("busList", saveList)
            window.location.reload()
        }
        setTimeout(() => {updateAllScroll()}, 1)


        // Event Listener for enter key on add stops button setting menu thingy 
        // Source - https://stackoverflow.com/a
        // Posted by Steve Paulo, modified by community. See post 'Timeline' for change history
        // Retrieved 2026-01-24, License - CC BY-SA 3.0
        // Attribution???? WHY?????

        document.getElementById("stopInput")
            .addEventListener("keyup", function(event) {
            event.preventDefault();
            if (event.keyCode === 13) {
                document.getElementById("newStopAdd").click();
            }
        });


        // a rat was here
    </script>
</body>
</html>
